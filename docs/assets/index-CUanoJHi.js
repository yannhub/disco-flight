(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const w of o.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&s(w)}).observe(document,{childList:!0,subtree:!0});function A(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(t){if(t.ep)return;t.ep=!0;const o=A(t);fetch(t.href,o)}})();const N="/disco-flight/assets/disco-music-4RV96TdM.mp3",F="/disco-flight/assets/explosion-BVY2a1Az.mp3",f=45,D=30,G=5,R=4,x=3e3,V=.05,H=-4;let c="welcome",E=!1,r=0,h=0,p=0,u=!1,d=null,M=Date.now(),v=0,C=0,T=0,a,i,m;const g=new Audio(N),W=new Audio(F),$=document.getElementById("welcome-screen"),z=document.getElementById("orientation-screen"),O=document.getElementById("game-screen"),X=document.getElementById("gameover-screen"),b=document.getElementById("start-button"),_=document.getElementById("restart-button"),y=document.querySelector("#sky-video"),B=document.querySelector("#copilot"),Y=document.getElementById("detection-bar"),L=document.createElement("div");L.id="debug-window";L.style.display="none";document.body.appendChild(L);function l(e){[$,z,O,X].forEach(n=>{n.classList.add("hidden")}),document.getElementById(e).classList.remove("hidden")}function S(){var e;return window.innerHeight>window.innerWidth?(E=!1,c==="playing"&&(l("orientation-screen"),y.pause(),a&&i.stop()),!1):(E=!0,((e=document.getElementById("orientation-screen"))==null?void 0:e.classList.contains("hidden"))===!1&&(c==="playing"?(l("game-screen"),y.play(),a&&(i=a.createOscillator(),i.connect(m),i.type="sawtooth",i.start()),I(performance.now())):l(c==="welcome"?"welcome-screen":"gameover-screen")),!0)}function k(){const e=p/D*100;Y.style.setProperty("--detection-percentage",`${e}%`)}function K(){if(u){d&&clearTimeout(d),d=window.setTimeout(()=>{q()},G*1e3);return}u=!0,O.classList.add("disco-mode"),g.currentTime=C,g.play()}function q(){u&&(u=!1,O.classList.remove("disco-mode"),C=g.currentTime,g.pause(),d&&(clearTimeout(d),d=null))}function j(){i.frequency.value=100+r/f*50}function J(){const e=Date.now();if(e-M>x){const n=f*.7;h=Math.random()*n*2-n,M=e}r+=(h-r)*V}function Q(){const e=Math.abs(r)/f,n=R*e;let s=parseFloat(B.style.left)||50;if(r!==0){const t=r>0?1:-1;s+=t*n}if(v!==0){const t=v/f*H;s-=t}s=Math.max(10,Math.min(90,s)),B.style.left=`${s}%`,(s<=10||s>=90)&&K()}function I(e){if(c==="playing"&&E){const n=(e-T)/1e3;T=e,J(),Q(),j(),u&&(p+=n,k(),p>=D&&(c="gameover",Z())),y.style.transform=`rotate(${-r}deg)`,requestAnimationFrame(I)}}function U(e){c==="playing"&&(v=e.beta||0)}function P(){c="playing",p=0,r=0,h=0,u=!1,T=performance.now(),a=new AudioContext,i=a.createOscillator(),m=a.createGain(),i.connect(m),m.connect(a.destination),i.type="sawtooth",m.gain.value=.1,S(),l("game-screen"),y.play(),i.start(),requestAnimationFrame(I)}function Z(){c="gameover",l("gameover-screen"),q(),i.stop(),W.play(),setTimeout(()=>{_.classList.remove("hidden")},2e3)}b.addEventListener("click",P);_.addEventListener("click",P);window.addEventListener("orientationchange",()=>{setTimeout(S,100)});window.addEventListener("resize",()=>{setTimeout(S,100)});window.addEventListener("deviceorientation",U);document.addEventListener("DOMContentLoaded",()=>{l("welcome-screen"),typeof DeviceOrientationEvent.requestPermission=="function"&&b.addEventListener("click",async()=>{try{await DeviceOrientationEvent.requestPermission()==="granted"&&P()}catch(e){console.error("Permission denied:",e)}})});
//# sourceMappingURL=index-CUanoJHi.js.map
