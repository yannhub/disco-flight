(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const w of o.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&s(w)}).observe(document,{childList:!0,subtree:!0});function P(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(e){if(e.ep)return;e.ep=!0;const o=P(e);fetch(e.href,o)}})();const _="/disco-flight/assets/disco-music-4RV96TdM.mp3",N="/disco-flight/assets/explosion-BVY2a1Az.mp3",f=45,B=30,q=5,F=1,G=3e3,R=.05,x=-.8;let c="welcome",E=!1,r=0,h=0,p=0,u=!1,d=null,A=Date.now(),v=0,a,i,m;const g=new Audio(_),V=new Audio(N),H=document.getElementById("welcome-screen"),W=document.getElementById("orientation-screen"),O=document.getElementById("game-screen"),$=document.getElementById("gameover-screen"),D=document.getElementById("start-button"),C=document.getElementById("restart-button"),y=document.querySelector("#sky-video"),M=document.querySelector("#copilot"),z=document.getElementById("detection-bar"),T=document.createElement("div");T.id="debug-window";T.style.display="none";document.body.appendChild(T);function l(t){[H,W,O,$].forEach(n=>{n.classList.add("hidden")}),document.getElementById(t).classList.remove("hidden")}function L(){var t;return window.innerHeight>window.innerWidth?(E=!1,c==="playing"&&(l("orientation-screen"),y.pause(),a&&i.stop()),!1):(E=!0,((t=document.getElementById("orientation-screen"))==null?void 0:t.classList.contains("hidden"))===!1&&(c==="playing"?(l("game-screen"),y.play(),a&&(i=a.createOscillator(),i.connect(m),i.type="sawtooth",i.start()),S()):l(c==="welcome"?"welcome-screen":"gameover-screen")),!0)}function X(){const t=p/B*100;z.style.setProperty("--detection-percentage",`${t}%`)}function Y(){u||(u=!0,O.classList.add("disco-mode"),g.currentTime=0,g.play(),d&&clearTimeout(d),d=window.setTimeout(()=>{b()},q*1e3))}function b(){u&&(u=!1,O.classList.remove("disco-mode"),g.pause(),g.currentTime=0,d&&(clearTimeout(d),d=null))}function k(){i.frequency.value=100+r/f*50}function K(){const t=Date.now();if(t-A>G){const n=f*.7;h=Math.random()*n*2-n,A=t}r+=(h-r)*R}function j(){const t=Math.abs(r)/f,n=F*t;let s=parseFloat(M.style.left)||50;if(r!==0){const e=r>0?1:-1;s+=e*n}if(v!==0){const e=v/f*x;s-=e}s=Math.max(10,Math.min(90,s)),M.style.left=`${s}%`,(s<=10||s>=90)&&Y()}function S(){c==="playing"&&E&&(K(),j(),k(),u&&(p+=1/60,X(),p>=B&&(c="gameover",Q())),y.style.transform=`rotate(${-r}deg)`,requestAnimationFrame(S))}function J(t){c==="playing"&&(v=t.beta||0)}function I(){c="playing",p=0,r=0,h=0,u=!1,a=new AudioContext,i=a.createOscillator(),m=a.createGain(),i.connect(m),m.connect(a.destination),i.type="sawtooth",m.gain.value=.1,L(),l("game-screen"),y.play(),i.start(),S()}function Q(){c="gameover",l("gameover-screen"),b(),i.stop(),V.play(),setTimeout(()=>{C.classList.remove("hidden")},5e3)}D.addEventListener("click",I);C.addEventListener("click",I);window.addEventListener("orientationchange",()=>{setTimeout(L,100)});window.addEventListener("resize",()=>{setTimeout(L,100)});window.addEventListener("deviceorientation",J);document.addEventListener("DOMContentLoaded",()=>{l("welcome-screen"),typeof DeviceOrientationEvent.requestPermission=="function"&&D.addEventListener("click",async()=>{try{await DeviceOrientationEvent.requestPermission()==="granted"&&I()}catch(t){console.error("Permission denied:",t)}})});
//# sourceMappingURL=index-B4VMn_f3.js.map
