(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const S of o.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&n(S)}).observe(document,{childList:!0,subtree:!0});function E(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(t){if(t.ep)return;t.ep=!0;const o=E(t);fetch(t.href,o)}})();const J="/disco-flight/assets/disco-music-CF8K-ThL.mp3",Q="/disco-flight/assets/explosion-BVY2a1Az.mp3",y=45,H=15,U=3,Z=2.5,ee=1e3,P=20,k=.01,te=-3,ne=.5;let c="welcome",A=!1,s=0,w=0,M=P,h=0,m=!1,a=null,N=Date.now(),g=0,$=0,f=0,T=0,V=0,F=0,v,d,l,L;const p=new Audio(J),b=new Audio(Q),oe=document.getElementById("welcome-screen"),ie=document.getElementById("orientation-screen"),B=document.getElementById("game-screen"),se=document.getElementById("gameover-screen"),W=document.getElementById("gameover-actions"),Y=document.getElementById("start-button"),ce=document.getElementById("restart-button"),I=document.getElementById("install-button"),O=document.querySelector("#sky-video"),q=document.querySelector("#copilot"),le=document.getElementById("detection-bar"),re=document.getElementById("time-counter"),ae=document.getElementById("final-score"),C=document.createElement("div");C.id="debug-window";C.style.display="none";document.body.appendChild(C);let r;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),r=e,I.style.display="block"});I.addEventListener("click",async()=>{if(r){r.prompt();const{outcome:e}=await r.userChoice;e==="accepted"&&console.log("Application installée"),r=null,I.style.display="none"}});window.addEventListener("appinstalled",()=>{console.log("Application installée avec succès"),I.style.display="none",r=null});function u(e){[oe,ie,B,se].forEach(i=>{i.classList.add("hidden")}),document.getElementById(e).classList.remove("hidden")}function _(){var e;return window.innerHeight>window.innerWidth?(A=!1,c==="playing"&&(u("orientation-screen"),D(),O.pause(),d&&l.stop()),!1):(A=!0,((e=document.getElementById("orientation-screen"))==null?void 0:e.classList.contains("hidden"))===!1&&(c==="playing"?(u("game-screen"),O.play(),d&&(j(),l.start()),f=performance.now(),R(f)):u(c==="welcome"?"welcome-screen":"gameover-screen")),!0)}function de(){m&&(h+=T);const e=h/H*100;le.style.setProperty("--detection-percentage",`${e}%`)}function ue(){if(navigator.vibrate&&navigator.vibrate(200),m){a&&clearTimeout(a),a=window.setTimeout(()=>{D()},U*1e3);return}m=!0,B.classList.add("disco-mode"),p.currentTime=$,p.play()}function D(){m&&(m=!1,B.classList.remove("disco-mode"),$=p.currentTime,p.pause(),a&&(clearTimeout(a),a=null))}function me(){l.frequency.value=100+s/y*50}function fe(){const e=Date.now();e-N>ee&&(w=Math.random()*y*2-y,N=e,M=Math.random()*P+P),Math.abs(w-s)>ne&&(w>s?s+=T*M:s-=T*M),O.style.transform=`rotate(${-s}deg)`}function pe(){const e=Math.abs(s)/y,i=Z*e;let n=parseFloat(q.style.left)||50;if(s!==0){const t=s>0?1:-1;n+=t*i}if(g!==0){const t=g/y*te;n-=t}n=Math.max(10,Math.min(90,n)),q.style.left=`${n}%`,(n<=13||n>=87)&&ue()}function R(e){c==="playing"&&A&&(T=(e-f)/1e3,f=e,F=(e-V)/100,re.textContent=F.toFixed(0),fe(),pe(),me(),de(),h>=H&&(c="gameover",Ee()),requestAnimationFrame(R))}function ge(e){if(c==="playing"){g=e.beta||0;const i=e.beta||0,E=e.gamma||0,t=Math.atan2(Math.sin(E*Math.PI/180),Math.tan(i*Math.PI/180))*180/Math.PI;g=g*(1-k)+t*k}}function K(){const e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}function ye(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}function X(){document.fullscreenElement?ye():K()}var G;(G=document.getElementById("toggle-fullscreen-orientation"))==null||G.addEventListener("click",X);var z;(z=document.getElementById("toggle-fullscreen-gameover"))==null||z.addEventListener("click",X);async function x(){c="playing",h=0,s=0,w=0,m=!1,f=performance.now(),V=f,F=0,"wakeLock"in navigator&&(v=await navigator.wakeLock.request("screen")),d=new AudioContext,L=d.createGain(),L.connect(d.destination),L.gain.value=.1,j(),p.play(),p.pause(),b.play(),b.pause(),W.classList.add("hidden"),q.style.left="50%",u("game-screen"),O.play(),l.start(),K(),_(),requestAnimationFrame(R)}function j(){l=d.createOscillator(),l.connect(L),l.type="sawtooth"}function Ee(){c="gameover",ae.textContent=`Score: ${F.toFixed(2)}`,u("gameover-screen"),D(),l.stop(),b.play(),v&&v.release().then(()=>{v=null}),setTimeout(()=>{W.classList.remove("hidden")},1e3)}Y.addEventListener("click",x);ce.addEventListener("click",x);window.addEventListener("orientationchange",()=>{setTimeout(_,100)});window.addEventListener("resize",()=>{setTimeout(_,100)});window.addEventListener("deviceorientation",ge);document.addEventListener("DOMContentLoaded",()=>{u("welcome-screen"),typeof DeviceOrientationEvent.requestPermission=="function"&&Y.addEventListener("click",async()=>{try{await DeviceOrientationEvent.requestPermission()==="granted"&&x()}catch(e){console.error("Permission denied:",e)}})});
//# sourceMappingURL=index-CHO6jzuf.js.map
